# GitHub Actions Workflows

Этот репозиторий содержит несколько GitHub Actions workflows для автоматизации процессов разработки и тестирования.

## Доступные Workflows

### 1. Tests (`tests.yml`)

- **Триггер**: Push в `main`/`develop`, Pull Request, Manual
- **Описание**: Выолняет все тесты на Ubuntu
- **Особенности**:
  - Простые тесты (без API вызовов)
  - API тесты с использованием секретов
  - Комментирование PR с результатами тестов

### 2. Test Matrix (`test-matrix.yml`)

- **Триггер**: Push в `main`/`develop`, Pull Request, Manual
- **Описание**: Выполняет тесты на разных платформах (Ubuntu, Windows, macOS)
- **Особенности**:
  - Матричное тестирование
  - Покрытие кода тестами
  - Загрузка артефактов тестирования

### 3. NuGet Publish (`nuget-publish.yml`)

- **Триггер**: Push тегов `v*`, Manual
- **Описание**: Публикует NuGet пакет после успешного выполнения всех тестов
- **Особенности**:
  - **Зависимости**: Выполняется только после успешного завершения `test`, `test-matrix` и `test-coverage`
  - Автоматическая публикация при создании тега версии
  - Создание GitHub Release

  - Использует секрет `NUGET_API_KEY`

### 4. Другие Workflows

- `pr-status.yml` - Проверка статуса Pull Request
- `gi-build.yml` - Сборка Genshin Impact
- `dotnet.yml` - Сборка .NET
- `auth-build.yml` - Сборка Auth модуля

## Как опубликовать NuGet пакет

### Автоматическая публикация

1. Убедитесь, что все тесты проходят успешно

2. Создайте и запушьте тег версии:

   ```bash
   git tag v1.3.1
   git push origin v1.3.1
   ```

3. Workflow автоматически:
   - Запустит все тесты
   - После успешного выполнения тестов опубликует пакет в NuGet
   - Создаст GitHub Release

### Ручная публикация

1. Перейдите в Actions → NuGet Publish
2. Нажмите "Run workflow"
3. Выберите ветку (обычно `main`)
4. Нажмите "Run workflow"

## Требования

### Секреты

- `NUGET_API_KEY` - API ключ для публикации в NuGet
- `LTMID_V2`, `LTOKEN_V2`, `LTUID_V2` - Токены для API тестов

### Условия публикации

- Все тесты должны пройти успешно
- Публикация происходит только при push тегов версии
- Пакет собирается в Release конфигурации

## Структура зависимостей

```
nuget-publish.yml
├── test (tests.yml)
├── test-matrix (test-matrix.yml)
└── test-coverage (test-matrix.yml)
```

Публикация NuGet пакета происходит только после успешного выполнения всех зависимых jobs.

## Мониторинг

- Проверяйте статус выполнения в Actions
- Логи тестирования доступны в артефактах
- Результаты покрытия кода загружаются автоматически
